<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>{{title}}</title>

    <link rel="apple-touch-icon" href="{{joinBase 'images/lbh3_rabbit_logo.png'}}">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="LBH3">

    <meta name="msapplication-TileColor" content="#d02d33">
    <meta name="msapplication-TileImage" content="{{joinBase 'images/lbh3_rabbit_logo.png'}}">

    <meta name="theme-color" content="#d02d33">

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-91420608-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());
      gtag('config', 'UA-91420608-1');
    </script>

  </head>
  <body>
    <can-import from="bootstrap/dist/css/bootstrap.css" />
    <can-import from="lbh3/styles.less" />
    <can-import from="lbh3/app" export-as="viewModel" />
    <can-import from="lbh3/components/footer/" />
    <can-import from="lbh3/components/header/" />
    <can-import from="lbh3/components/nav/" />

    <header>
      <lbh3-header />
      <lbh3-nav {page}="page" {year}="year" />
    </header>

    <main class="container {{page}}">
      {{#switch page}}
        {{#case "about"}}
          {{#switch secondaryPage}}
            {{#case "mismanagement"}}
              <can-import from="lbh3/components/about/mismanagement/">
                {{#if isPending}}
                  Loading Mismanagement…
                {{else}}
                  <lbh3-about-mismanagement />
                {{/if}}
              </can-import>
            {{/case}}
            {{#default}}
              <can-import from="lbh3/components/about/">
                {{#if isPending}}
                  Loading about page…
                {{else}}
                  <lbh3-about {secondary-page}="secondaryPage" />
                {{/if}}
              </can-import>
            {{/default}}
          {{/switch}}
        {{/case}}
        {{#case "admin"}}
          <can-import from="lbh3/components/admin/">
            {{#if isPending}}
              Loading admin page…
            {{else}}
              <lbh3-admin {secondary-page}="secondaryPage" />
            {{/if}}
          </can-import>
        {{/case}}
        {{#case "events"}}
          {{#if secondaryPage}}
            {{#switch secondaryPage}}
              {{#case "edit"}}
                <lbh3-no-ssr>
                  <can-import from="lbh3/components/run/edit/">
                    {{#if isPending}}
                      Loading the edit run page…
                    {{else}}
                      <lbh3-run-edit
                        {day}="day"
                        {month}="month"
                        {trail-number}="trailNumber"
                        {year}="year"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
              {{#case "jesus-cuervo-1800-trail"}}
                <can-import from="lbh3/components/jesus-cuervo/">
                  {{#if isPending}}
                    Loading…
                  {{else}}
                    <lbh3-jesus-cuervo />
                  {{/if}}
                </can-import>
              {{/case}}
            {{/switch}}
          {{else}}
            {{#if trailNumber}}
              <can-import from="lbh3/components/run/">
                {{#if isPending}}
                  Loading trail #{{trailNumber}}…
                {{else}}
                  <lbh3-run
                    {day}="day"
                    {month}="month"
                    {trail-number}="trailNumber"
                    {year}="year"
                  />
                {{/if}}
              </can-import>
            {{else}}
              <can-import from="lbh3/components/past-runs/">
                {{#if isPending}}
                  Loading Past Runs…
                {{else}}
                  <lbh3-past-runs {year}="year" />
                {{/if}}
              </can-import>
            {{/if}}
          {{/if}}
        {{/case}}
        {{#case "hareline"}}
          {{#switch secondaryPage}}
            {{#case "add"}}
              <lbh3-no-ssr>
                <can-import from="lbh3/components/hareline/add/">
                  {{#if isPending}}
                    Loading the Hareline add page…
                  {{else}}
                    <lbh3-hareline-add />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/case}}
            {{#case "edit"}}
              <lbh3-no-ssr>
                <can-import from="lbh3/components/run/edit/">
                  {{#if isPending}}
                    Loading the edit run page…
                  {{else}}
                    <lbh3-run-edit
                      {day}="day"
                      {month}="month"
                      {trail-number}="trailNumber"
                      {year}="year"
                    />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/case}}
            {{#case "guidelines"}}
              <can-import from="lbh3/components/hareline/guidelines/">
                {{#if isPending}}
                  Loading haring guidelines…
                {{else}}
                  <lbh3-hareline-guidelines />
                {{/if}}
              </can-import>
            {{/case}}
            {{#default}}
              <can-import from="lbh3/components/hareline/">
                {{#if isPending}}
                  Loading the Hareline…
                {{else}}
                  <lbh3-hareline />
                {{/if}}
              </can-import>
            {{/default}}
          {{/switch}}
        {{/case}}
        {{#case "home"}}
          <can-import from="lbh3/components/home/">
            {{#if isPending}}
              Loading home page…
            {{else}}
              <lbh3-home />
            {{/if}}
          </can-import>
        {{/case}}
      {{/switch}}
    </main>

    <lbh3-footer />

    {{#switch env.NODE_ENV}}
      {{#case "production"}}
        <script src="{{joinBase 'steal.production.js'}}"></script>
      {{/case}}
      {{#default}}
        <script src="/node_modules/steal/steal.js"></script>
      {{/default}}
    {{/switch}}
  </body>
</html>
