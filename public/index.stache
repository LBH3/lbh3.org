<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">

    <title>{{title}}</title>
    <meta name="description" content="{{description}}">

    {{! Apple }}
    <link rel="apple-touch-icon" href="{{joinBase 'assets/apple-touch-icon-180x180.png'}}" sizes="180x180">
    <link rel="mask-icon" href="{{joinBase 'assets/safari-pinned-tab.svg'}}" color="#dc3232">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="LBH3">

    {{! Facebook }}
    <meta property="fb:app_id" content="857733227744669">

    {{! Microsoft }}
    <meta name="msapplication-TileColor" content="#dc3232">
    <meta name="msapplication-config" content="{{joinBase 'assets/browserconfig.xml'}}">

    {{! Open Graph }}
    <meta property="og:image" content="https://www.lbh3.org/dist/assets/fb-image.png">
    <meta property="og:title" content="{{ogTitle}}">

    {{! Generic app metadata }}
    <link rel="manifest" href="{{joinBase 'assets/manifest.json'}}">
    <meta name="application-name" content="LBH3">
    <meta name="theme-color" content="#dc3232">
  </head>
  <body>
    <can-import from="~/styles.less" />
    <can-import from="~/app" export-as="viewModel" />
    <can-import from="~/components/alert/" />
    <can-import from="~/components/footer/" />
    <can-import from="~/components/header/" />
    <can-import from="~/components/nav/" />

    <header>
      <lbh3-header id:from="id" page:from="page" secondaryPage:from="secondaryPage" />
      <lbh3-nav day:from="day" month:from="month" page:from="page" year:from="year" />
    </header>

    <main class="container-fluid {{page}}">
      {{#switch page}}
        {{#case "about"}}
          <can-import class="container d-block pl-0 pr-0" from="~/components/about/nav/">
            {{#if isPending}}
              <lbh3-alert message:from="'Loading the About nav…'" />
            {{else}}
              <lbh3-about-nav secondaryPage:from="secondaryPage" />
            {{/if}}
          </can-import>
          {{#switch secondaryPage}}
            {{#case "mismanagement"}}
              <can-import class="container d-block pl-0 pr-0" from="~/components/about/mismanagement/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the Mismanagement page…'" />
                {{else}}
                  <lbh3-about-mismanagement description:to="description" ogTitle:to="ogTitle" title:to="title" year:bind="year" />
                {{/if}}
              </can-import>
            {{/case}}
            {{#case "privacy"}}
              <can-import class="container d-block pl-0 pr-0" from="~/components/about/privacy/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the Privacy page…'" />
                {{else}}
                  <lbh3-about-privacy description:to="description" ogTitle:to="ogTitle" title:to="title" />
                {{/if}}
              </can-import>
            {{/case}}
            {{#default}}
              <can-import class="container d-block pl-0 pr-0" from="~/components/about/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the About page…'" />
                {{else}}
                  <lbh3-about description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" />
                {{/if}}
              </can-import>
            {{/default}}
          {{/switch}}
        {{/case}}
        {{#case "erections"}}
          {{#if urlId}}
            {{#if secondaryPage}}
              {{#switch secondaryPage}}
                {{#case "ballots"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/erection/ballots/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Erection Ballots page…'" />
                      {{else}}
                        <lbh3-erection-ballots description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" urlId:from="urlId" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
                {{#case "edit"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/erection/edit/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Edit Erection page…'" />
                      {{else}}
                        <lbh3-erection-edit description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" urlId:from="urlId" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
                {{#case "eligibility"}}
                  <lbh3-no-ssr>
                    <can-import from="~/components/erection/eligibility/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Erection Eligibility page…'" />
                      {{else}}
                        <lbh3-erection-eligibility description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" urlId:from="urlId" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
                {{#case "results"}}
                  <lbh3-no-ssr>
                    <can-import from="~/components/erection/results/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Erection Results page…'" />
                      {{else}}
                        <lbh3-erection-results description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" urlId:from="urlId" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
              {{/switch}}
            {{else}}
              <can-import class="container d-block pl-0 pr-0" from="~/components/erection/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the Erection page…'" />
                {{else}}
                  <lbh3-erection description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" urlId:from="urlId" />
                {{/if}}
              </can-import>
            {{/if}}
          {{else}}
            <can-import from="~/components/erections/">
              {{#if isPending}}
                <lbh3-alert message:from="'Loading the Erections page…'" />
              {{else}}
                <lbh3-erections description:to="description" ogTitle:to="ogTitle" title:to="title" />
              {{/if}}
            </can-import>
          {{/if}}
        {{/case}}
        {{#case "events"}}
          {{#if secondaryPage}}
            {{#switch secondaryPage}}
              {{#case "attendance"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/run/attendance/">
                    {{#if isPending}}
                      <lbh3-alert message:from="'Loading the Run Attendance Sheet…'" />
                    {{else}}
                      <lbh3-run-attendance day:from="day" description:to="description" month:from="month" ogTitle:to="ogTitle" title:to="title" trailNumber:from="trailNumber" year:from="year" />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
              {{#case "edit"}}
                <lbh3-no-ssr>
                  {{#if urlId}}
                    <can-import class="container d-block pl-0 pr-0" from="~/components/special-event/edit/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Edit Special Event page…'" />
                      {{else}}
                        <lbh3-special-event-edit description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" urlId:from="urlId" year:from="year" />
                      {{/if}}
                    </can-import>
                  {{else}}
                    <can-import from="~/components/run/edit/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Edit Run page…'" />
                      {{else}}
                        <lbh3-run-edit day:from="day" description:to="description" month:from="month" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" trailNumber:from="trailNumber" year:from="year" />
                      {{/if}}
                    </can-import>
                  {{/if}}
                </lbh3-no-ssr>
              {{/case}}
            {{/switch}}
          {{else}}
            {{#if trailNumber}}
              <can-import from="~/components/run/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the Run page…'" />
                {{else}}
                  <lbh3-run day:from="day" description:to="description" month:from="month" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" trailNumber:from="trailNumber" year:from="year" />
                {{/if}}
              </can-import>
            {{else}}
              {{#if urlId}}
                <can-import class="container d-block pl-0 pr-0" from="~/components/special-event/">
                  {{#if isPending}}
                    <lbh3-alert message:from="'Loading the Special Event page…'" />
                  {{else}}
                    <lbh3-special-event description:to="description" ogTitle:to="ogTitle" title:to="title" urlId:from="urlId" year:from="year" />
                  {{/if}}
                </can-import>
              {{else}}
                <can-import from="~/components/past-runs/">
                  {{#if isPending}}
                    <lbh3-alert message:from="'Loading Past Runs…'" />
                  {{else}}
                    <lbh3-past-runs description:to="description" ogTitle:to="ogTitle" showHashit:bind="showHashit" showNotes:bind="showNotes" showOnOn:bind="showOnOn" showScribe:bind="showScribe" title:to="title" year:bind="year" />
                  {{/if}}
                </can-import>
              {{/if}}
            {{/if}}
          {{/if}}
        {{/case}}
        {{#case "hareline"}}
          {{<harelineNav}}
            <can-import from="~/components/hareline/nav/">
              {{#if isPending}}
                <lbh3-alert message:from="'Loading the Hareline nav…'" />
              {{else}}
                <lbh3-hareline-nav secondaryPage:from="secondaryPage" />
              {{/if}}
            </can-import>
          {{/harelineNav}}
          {{#switch secondaryPage}}
            {{#case "add"}}
              {{>harelineNav}}
              <lbh3-no-ssr>
                <can-import class="container d-block pl-0 pr-0" from="~/components/hareline/add/">
                  {{#if isPending}}
                    <lbh3-alert message:from="'Loading the Add Run page…'" />
                  {{else}}
                    <lbh3-hareline-add description:to="description" ogTitle:to="ogTitle" title:to="title" />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/case}}
            {{#case "edit"}}
              <lbh3-no-ssr>
                <can-import from="~/components/run/edit/">
                  {{#if isPending}}
                    <lbh3-alert message:from="'Loading the Edit Run page…'" />
                  {{else}}
                    <lbh3-run-edit day:from="day" description:to="description" month:from="month" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" trailNumber:from="trailNumber" year:from="year" />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/case}}
            {{#case "guidelines"}}
              {{>harelineNav}}
              <can-import class="container d-block pl-0 pr-0" from="~/components/hareline/guidelines/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the Haring Guidelines…'" />
                {{else}}
                  <lbh3-hareline-guidelines description:to="description" ogTitle:to="ogTitle" title:to="title" />
                {{/if}}
              </can-import>
            {{/case}}
            {{#default}}
              {{>harelineNav}}
              <can-import from="~/components/hareline/">
                {{#if isPending}}
                  <lbh3-alert message:from="'Loading the Hareline…'" />
                {{else}}
                  <lbh3-hareline description:to="description" ogTitle:to="ogTitle" title:to="title" />
                {{/if}}
              </can-import>
            {{/default}}
          {{/switch}}
        {{/case}}

        {{#case "hashers"}}
          {{#if id}}
            {{#if secondaryPage}}
              {{#switch secondaryPage}}
                {{#case "edit"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/hasher/edit/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Edit Hasher page…'" />
                      {{else}}
                        <lbh3-hasher-edit description:to="description" id:from="id" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
              {{/switch}}
            {{else}}
              <lbh3-no-ssr>
                <can-import from="~/components/hasher/">
                  {{#if isPending}}
                    <lbh3-alert message:from="'Loading the Hasher page…'" />
                  {{else}}
                    <lbh3-hasher description:to="description" id:from="id" ogTitle:to="ogTitle" role:bind="role" secondaryPage:from="secondaryPage" showHashit:bind="showHashit" showNotes:bind="showNotes" showOnOn:bind="showOnOn" showScribe:bind="showScribe" skip:from="skip" title:to="title" />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/if}}
          {{else}}
            <can-import class="container d-block pl-0 pr-0" from="~/components/hashers/nav/">
              {{#if isPending}}
                <lbh3-alert message:from="'Loading the Directory nav…'" />
              {{else}}
                <lbh3-hashers-nav secondaryPage:from="secondaryPage" />
              {{/if}}
            </can-import>
            {{#if secondaryPage}}
              {{#switch secondaryPage}}
                {{#case "add"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/hashers/add/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Add Hasher page…'" />
                      {{else}}
                        <lbh3-hashers-add description:to="description" ogTitle:to="ogTitle" title:to="title" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
                {{#case "attendance-records"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/hashers/attendance-records/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Attendance Records page…'" />
                      {{else}}
                        <lbh3-hashers-attendance-records description:to="description" ogTitle:to="ogTitle" title:to="title" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
                {{#case "early-warning"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/hashers/early-warning/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Early Warning page…'" />
                      {{else}}
                        <lbh3-hashers-early-warning description:to="description" ogTitle:to="ogTitle" title:to="title" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
                {{#case "email"}}
                  <lbh3-no-ssr>
                    <can-import class="container d-block pl-0 pr-0" from="~/components/hashers/email/">
                      {{#if isPending}}
                        <lbh3-alert message:from="'Loading the Email List page…'" />
                      {{else}}
                        <lbh3-hashers-email description:to="description" ogTitle:to="ogTitle" title:to="title" />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
              {{/switch}}
            {{else}}
              <lbh3-no-ssr>
                <can-import class="container d-block pl-0 pr-0" from="~/components/hashers/">
                  {{#if isPending}}
                    <lbh3-alert message:from="'Loading the Directory page…'" />
                  {{else}}
                    <lbh3-hashers description:to="description" ogTitle:to="ogTitle" searchNoHeadshot:bind="noHeadshot" searchSort:bind="sort" searchText:bind="search" skip:from="skip" title:to="title" />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/if}}
          {{/if}}
        {{/case}}
        {{#case "home"}}
          <can-import class="container d-block pl-0 pr-0" from="~/components/home/">
            {{#if isPending}}
              <lbh3-alert message:from="'Loading the next run…'" />
            {{else}}
              {{#if isRejected}}
                <div class="alert alert-danger" role="alert">
                  <strong>Fuck!</strong> The next run failed to load.
                  Check <a href="http://www.hash.org" target="_blank">hash.org</a> for the next run.
                </div>
              {{else}}
                <lbh3-home description:to="description" ogTitle:to="ogTitle" title:to="title" />
              {{/if}}
            {{/if}}
          </can-import>
        {{/case}}
        {{#case "special-events"}}
          <can-import from="~/components/special-events/">
            {{#if isPending}}
              <lbh3-alert message:from="'Loading the Special Events page…'" />
            {{else}}
              <lbh3-special-events description:to="description" ogTitle:to="ogTitle" title:to="title" />
            {{/if}}
          </can-import>
        {{/case}}
        {{#case "users"}}
          {{#if secondaryPage}}
            {{#switch secondaryPage}}
              {{#case "edit"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/users/edit/">
                    {{#if isPending}}
                      <lbh3-alert message:from="'Loading the Edit User page…'" />
                    {{else}}
                      <lbh3-user-edit description:to="description" id:from="id" ogTitle:to="ogTitle" title:to="title" />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
            {{/switch}}
          {{else}}
            <can-import from="~/components/users/">
              {{#if isPending}}
                <lbh3-alert message:from="'Loading the Users page…'" />
              {{else}}
                <lbh3-users description:to="description" ogTitle:to="ogTitle" secondaryPage:from="secondaryPage" title:to="title" />
              {{/if}}
            </can-import>
          {{/if}}
        {{/case}}
      {{/switch}}
    </main>

    <lbh3-footer class="d-print-none" />

    {{#switch nodeEnv}}
      {{#case "production"}}
        <script src="{{joinBase 'steal.production.js'}}"></script>
      {{/case}}
      {{#default}}
        <script src="/node_modules/steal/steal.js" main></script>
      {{/default}}
    {{/switch}}
  </body>
</html>
