<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">

    <title>{{title}}</title>
    <meta name="description" content="{{description}}">

    {{! Apple }}
    <link rel="apple-touch-icon" href="{{joinBase 'assets/apple-touch-icon-180x180.png'}}" sizes="180x180">
    <link rel="mask-icon" href="{{joinBase 'assets/safari-pinned-tab.svg'}}" color="#dc3232">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="LBH3">

    {{! Facebook }}
    <meta property="fb:app_id" content="857733227744669">

    {{! Microsoft }}
    <meta name="msapplication-TileColor" content="#dc3232">
    <meta name="msapplication-config" content="{{joinBase 'assets/browserconfig.xml'}}">

    {{! Open Graph }}
    <meta property="og:image" content="https://www.lbh3.org/dist/assets/fb-image.png">
    <meta property="og:title" content="{{ogTitle}}">

    {{! Generic app metadata }}
    <link rel="manifest" href="{{joinBase 'assets/manifest.json'}}">
    <meta name="application-name" content="LBH3">
    <meta name="theme-color" content="#dc3232">

    {{! Global Site Tag (gtag.js) - Google Analytics }}
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-91420608-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());
      gtag('config', 'UA-91420608-1');
    </script>
  </head>
  <body>
    <can-import from="~/styles.less" />
    <can-import from="~/app" export-as="viewModel" />
    <can-import from="~/components/footer/" />
    <can-import from="~/components/header/" />
    <can-import from="~/components/nav/" />

    <header>
      <lbh3-header />
      <lbh3-nav day:from="day" month:from="month" page:from="page" year:from="year" />
    </header>

    <main class="container {{page}}">
      {{#switch page}}
        {{#case "about"}}
          {{#switch secondaryPage}}
            {{#case "mismanagement"}}
              <can-import from="~/components/about/mismanagement/">
                {{#if isPending}}
                  Loading Mismanagement…
                {{else}}
                  <lbh3-about-mismanagement
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    title:to="scope.root.title"
                    year:from="scope.root.year"
                  />
                {{/if}}
              </can-import>
            {{/case}}
            {{#case "privacy"}}
              <can-import from="~/components/about/privacy/">
                {{#if isPending}}
                  Loading page…
                {{else}}
                  <lbh3-about-privacy
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    title:to="scope.root.title"
                  />
                {{/if}}
              </can-import>
            {{/case}}
            {{#default}}
              <can-import from="~/components/about/">
                {{#if isPending}}
                  Loading about page…
                {{else}}
                  <lbh3-about
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    secondaryPage:from="secondaryPage"
                    title:to="scope.root.title"
                  />
                {{/if}}
              </can-import>
            {{/default}}
          {{/switch}}
        {{/case}}
        {{#case "erections"}}
          {{#if urlId}}
            {{#if secondaryPage}}
              {{#switch secondaryPage}}
                {{#case "admin"}}
                  <lbh3-no-ssr>
                    <can-import from="~/components/erection/admin/">
                      {{#if isPending}}
                        Loading the erection admin page…
                      {{else}}
                        <lbh3-erection-admin
                          description:to="scope.root.description"
                          ogTitle:to="scope.root.ogTitle"
                          title:to="scope.root.title"
                          urlId:from="scope.root.urlId"
                        />
                      {{/if}}
                    </can-import>
                  </lbh3-no-ssr>
                {{/case}}
              {{/switch}}
            {{else}}
              <can-import from="~/components/erection/">
                {{#if isPending}}
                  Loading the erection page…
                {{else}}
                  <lbh3-erection
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    title:to="scope.root.title"
                    urlId:from="scope.root.urlId"
                  />
                {{/if}}
              </can-import>
            {{/if}}
          {{else}}
            <can-import from="~/components/erections/">
              {{#if isPending}}
                Loading the erections page…
              {{else}}
                <lbh3-erections
                  description:to="scope.root.description"
                  ogTitle:to="scope.root.ogTitle"
                  title:to="scope.root.title"
                />
              {{/if}}
            </can-import>
          {{/if}}
        {{/case}}
        {{#case "events"}}
          {{#if secondaryPage}}
            {{#switch secondaryPage}}
              {{#case "attendance"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/run/attendance/">
                    {{#if isPending}}
                      Loading the run attendance sheet page…
                    {{else}}
                      <lbh3-run-attendance
                        day:from="scope.root.day"
                        description:to="scope.root.description"
                        month:from="scope.root.month"
                        ogTitle:to="scope.root.ogTitle"
                        title:to="scope.root.title"
                        trailNumber:from="scope.root.trailNumber"
                        year:from="scope.root.year"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
              {{#case "edit"}}
                <lbh3-no-ssr>
                  {{#if urlId}}
                    <can-import from="~/components/special-event/edit/">
                      {{#if isPending}}
                        Loading the edit page…
                      {{else}}
                        <lbh3-special-event-edit
                          description:to="scope.root.description"
                          ogTitle:to="scope.root.ogTitle"
                          title:to="scope.root.title"
                          urlId:from="scope.root.urlId"
                          year:from="scope.root.year"
                        />
                      {{/if}}
                    </can-import>
                  {{else}}
                    <can-import from="~/components/run/edit/">
                      {{#if isPending}}
                        Loading the edit run page…
                      {{else}}
                        <lbh3-run-edit
                          day:from="scope.root.day"
                          description:to="scope.root.description"
                          month:from="scope.root.month"
                          ogTitle:to="scope.root.ogTitle"
                          title:to="scope.root.title"
                          trailNumber:from="scope.root.trailNumber"
                          year:from="scope.root.year"
                        />
                      {{/if}}
                    </can-import>
                  {{/if}}
                </lbh3-no-ssr>
              {{/case}}
              {{#case "founders"}}
                <can-import from="~/components/founders-2018/">
                  {{#if isPending}}
                    Loading…
                  {{else}}
                    <lbh3-founders-2018
                      description:to="scope.root.description"
                      ogTitle:to="scope.root.ogTitle"
                      title:to="scope.root.title"
                    />
                  {{/if}}
                </can-import>
              {{/case}}
              {{#case "memorial-service"}}
                <can-import from="~/components/memorial-service/">
                  {{#if isPending}}
                    Loading…
                  {{else}}
                    <lbh3-memorial-service
                      description:to="scope.root.description"
                      ogTitle:to="scope.root.ogTitle"
                      title:to="scope.root.title"
                    />
                  {{/if}}
                </can-import>
              {{/case}}
            {{/switch}}
          {{else}}
            {{#if trailNumber}}
              <can-import from="~/components/run/">
                {{#if isPending}}
                  Loading trail #{{scope.root.trailNumber}}…
                {{else}}
                  <lbh3-run
                    day:from="scope.root.day"
                    description:to="scope.root.description"
                    month:from="scope.root.month"
                    ogTitle:to="scope.root.ogTitle"
                    title:to="scope.root.title"
                    trailNumber:from="scope.root.trailNumber"
                    year:from="scope.root.year"
                  />
                {{/if}}
              </can-import>
            {{else}}
              {{#if urlId}}
                <can-import from="~/components/special-event/">
                  {{#if isPending}}
                    Loading…
                  {{else}}
                    <lbh3-special-event
                      description:to="scope.root.description"
                      ogTitle:to="scope.root.ogTitle"
                      title:to="scope.root.title"
                      urlId:from="scope.root.urlId"
                      year:from="scope.root.year"
                    />
                  {{/if}}
                </can-import>
              {{else}}
                <can-import from="~/components/past-runs/">
                  {{#if isPending}}
                    Loading Past Runs…
                  {{else}}
                    <lbh3-past-runs
                      description:to="scope.root.description"
                      ogTitle:to="scope.root.ogTitle"
                      title:to="scope.root.title"
                      year:from="scope.root.year"
                    />
                  {{/if}}
                </can-import>
              {{/if}}
            {{/if}}
          {{/if}}
        {{/case}}
        {{#case "hareline"}}
          {{#switch secondaryPage}}
            {{#case "add"}}
              <lbh3-no-ssr>
                <can-import from="~/components/hareline/add/">
                  {{#if isPending}}
                    Loading the Hareline add page…
                  {{else}}
                    <lbh3-hareline-add
                      description:to="scope.root.description"
                      ogTitle:to="scope.root.ogTitle"
                      title:to="scope.root.title"
                    />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/case}}
            {{#case "edit"}}
              <lbh3-no-ssr>
                <can-import from="~/components/run/edit/">
                  {{#if isPending}}
                    Loading the edit run page…
                  {{else}}
                    <lbh3-run-edit
                      day:from="scope.root.day"
                      description:to="scope.root.description"
                      month:from="scope.root.month"
                      ogTitle:to="scope.root.ogTitle"
                      title:to="scope.root.title"
                      trailNumber:from="scope.root.trailNumber"
                      year:from="scope.root.year"
                    />
                  {{/if}}
                </can-import>
              </lbh3-no-ssr>
            {{/case}}
            {{#case "guidelines"}}
              <can-import from="~/components/hareline/guidelines/">
                {{#if isPending}}
                  Loading haring guidelines…
                {{else}}
                  <lbh3-hareline-guidelines
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    title:to="scope.root.title"
                  />
                {{/if}}
              </can-import>
            {{/case}}
            {{#default}}
              <can-import from="~/components/hareline/">
                {{#if isPending}}
                  Loading the Hareline…
                {{else}}
                  <lbh3-hareline
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    title:to="scope.root.title"
                  />
                {{/if}}
              </can-import>
            {{/default}}
          {{/switch}}
        {{/case}}
        {{#case "hashers"}}
          {{#if secondaryPage}}
            {{#switch secondaryPage}}
              {{#case "add"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/hashers/add/">
                    {{#if isPending}}
                      Loading the add hasher page…
                    {{else}}
                      <lbh3-hashers-add
                        description:to="scope.root.description"
                        ogTitle:to="scope.root.ogTitle"
                        title:to="scope.root.title"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
              {{#case "early-warning"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/hashers/early-warning/">
                    {{#if isPending}}
                      Loading the early warning page…
                    {{else}}
                      <lbh3-hashers-early-warning
                        description:to="scope.root.description"
                        ogTitle:to="scope.root.ogTitle"
                        title:to="scope.root.title"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
              {{#case "email"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/hashers/email/">
                    {{#if isPending}}
                      Loading the hashers email page…
                    {{else}}
                      <lbh3-hashers-email
                        description:to="scope.root.description"
                        ogTitle:to="scope.root.ogTitle"
                        title:to="scope.root.title"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
              {{#case "edit"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/hasher/edit/">
                    {{#if isPending}}
                      Loading the edit hasher page…
                    {{else}}
                      <lbh3-hasher-edit
                        description:to="scope.root.description"
                        id:from="scope.root.id"
                        ogTitle:to="scope.root.ogTitle"
                        title:to="scope.root.title"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
            {{/switch}}
          {{else}}
            {{#if id}}
              <can-import from="~/components/hasher/">
                {{#if isPending}}
                  Loading hasher page…
                {{else}}
                  <lbh3-hasher
                    description:to="scope.root.description"
                    id:from="scope.root.id"
                    ogTitle:to="scope.root.ogTitle"
                    skip:from="scope.root.skip"
                    title:to="scope.root.title"
                  />
                {{/if}}
              </can-import>
            {{else}}
              <can-import from="~/components/hashers/">
                {{#if isPending}}
                  Loading Hashers page…
                {{else}}
                  <lbh3-hashers
                    description:to="scope.root.description"
                    ogTitle:to="scope.root.ogTitle"
                    searchNoHeadshot:bind="scope.root.noHeadshot"
                    searchText:bind="scope.root.search"
                    skip:from="scope.root.skip"
                    title:to="scope.root.title"
                  />
                {{/if}}
              </can-import>
            {{/if}}
          {{/if}}
        {{/case}}
        {{#case "home"}}
          <can-import from="~/components/home/">
            {{#if isPending}}
              <div class="alert alert-info" role="alert">
                <strong>Fetching the next run…</strong>
              </div>
            {{else}}
              {{#if isRejected}}
                <div class="alert alert-danger" role="alert">
                  <strong>Fuck!</strong> The next run failed to load.
                  Check <a href="http://www.hash.org" target="_blank">hash.org</a> for the next run.
                </div>
              {{else}}
                <lbh3-home
                  description:to="scope.root.description"
                  ogTitle:to="scope.root.ogTitle"
                  title:to="scope.root.title"
                />
              {{/if}}
            {{/if}}
          </can-import>
        {{/case}}
        {{#case "special-events"}}
          <can-import from="~/components/special-events/">
            {{#if isPending}}
              Loading special events page…
            {{else}}
              <lbh3-special-events
                description:to="scope.root.description"
                ogTitle:to="scope.root.ogTitle"
                title:to="scope.root.title"
              />
            {{/if}}
          </can-import>
        {{/case}}
        {{#case "users"}}
          {{#if secondaryPage}}
            {{#switch secondaryPage}}
              {{#case "edit"}}
                <lbh3-no-ssr>
                  <can-import from="~/components/users/edit/">
                    {{#if isPending}}
                      Loading the edit user page…
                    {{else}}
                      <lbh3-user-edit
                        description:to="scope.root.description"
                        id:from="scope.root.id"
                        ogTitle:to="scope.root.ogTitle"
                        title:to="scope.root.title"
                      />
                    {{/if}}
                  </can-import>
                </lbh3-no-ssr>
              {{/case}}
            {{/switch}}
          {{else}}
            <can-import from="~/components/users/">
              {{#if isPending}}
                Loading users page…
              {{else}}
                <lbh3-users
                  description:to="scope.root.description"
                  ogTitle:to="scope.root.ogTitle"
                  secondaryPage:from="secondaryPage"
                  title:to="scope.root.title"
                />
              {{/if}}
            </can-import>
          {{/if}}
        {{/case}}
      {{/switch}}
    </main>

    <lbh3-footer class="d-print-none" />

    {{#switch env.NODE_ENV}}
      {{#case "production"}}
        <script src="{{joinBase 'steal.production.js'}}"></script>
      {{/case}}
      {{#default}}
        <script src="/node_modules/steal/steal.js"></script>
      {{/default}}
    {{/switch}}
  </body>
</html>
